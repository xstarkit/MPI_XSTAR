<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>MPI_XSTAR by xstarkit</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>MPI_XSTAR</h1>
          <h2>MPI_XSTAR - MPI-based Parallelization of XSTAR Photoionization Program</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/xstarkit/MPI_XSTAR/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/xstarkit/MPI_XSTAR/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/xstarkit/MPI_XSTAR" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">

<div class="document" id="mpi-xstar">

<h2 class="title">MPI_XSTAR</h2>
  
<p><strong>MPI-based parallelization of XSTAR photoionization program</strong></p>

<a class="reference external image-reference" href="https://app.travis-ci.com/github/xstarkit/MPI_XSTAR"><img alt="Build Status" src="https://app.travis-ci.com/xstarkit/MPI_XSTAR.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://github.com/xstarkit/MPI_XSTAR/blob/master/LICENSE"><object data="https://img.shields.io/badge/license-GPL-blue.svg" type="image/svg+xml">GitHub license</object></a>
<a class="reference external image-reference" href="https://doi.org/10.5281/zenodo.1890561"><object data="https://img.shields.io/badge/DOI-10.5281/zenodo.1890561-blue.svg" type="image/svg+xml">Zenodo</object></a>
<a class="reference external image-reference" href="https://ui.adsabs.harvard.edu/abs/2017ascl.soft12002D/abstract"><object data="https://img.shields.io/badge/ASCL-1712.002-green.svg" type="image/svg+xml">ASCL</object></a>
<a class="reference external image-reference" href="https://doi.org/10.1088/1538-3873/aa9dff"><object data="https://img.shields.io/badge/DOI-10.1088%2F1538--3873%2Faa9dff-blue.svg" type="image/svg+xml">DOI</object></a>

<div class="section" id="description">
<h2>Description</h2>
  
<p>MPI_XSTAR: A parallel execution of multiple <a class="reference external" href="https://heasarc.gsfc.nasa.gov/xstar/xstar.html">XSTAR</a> runs using <a class="reference external" href="http://www.mpi-forum.org/docs/docs.html">Message Passing Interface</a> (MPI). XSTAR is part of the <a class="reference external" href="http://heasarc.nasa.gov/lheasoft/">HEASARC's standard HEADAS package</a>, and is a computer program used for calculating the physical conditions and emission spectra of photoionized gases (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2001ApJS..133..221K/abstract">Kallman &amp; Bautista 2001</a>).</p>
<p>The master program (rank=0) runs xstinitable from the HEADAS to create a list of XSTAR commands for given physical parameters, so called joblist, as well as a xstinitable.fits file, which is necessary for producing xout_ain.fits, xout_aout.fits, and xout_mtable.fits. The joblist is used to create directories in ascending order, where each individual xstar is spawned on each processor and outputs are saved. When each processor spawns the xstar, the main thread is waited until the xstar execution is completed.</p>
<p>The master program (rank=0) then invokes xstar2table from the HEADAS upon the contents of each directory in order to produce table model files, namely xout_ain.fits, xout_aout.fits, and xout_mtable.fits, suitable for spectroscopy analysis tools such as <a class="reference external" href="http://space.mit.edu/asc/isis/">ISIS</a> or <a class="reference external" href="https://heasarc.gsfc.nasa.gov/xanadu/xspec/">XSPEC</a>.</p>
</div>
<div class="section" id="installation">
<h2>Installation</h2>
<p>1: Pre-compile Step:</p>
<p>Set OpenMPI Path (bash):</p>
<pre class="code literal-block">
export PATH=&quot;/../openmpi/bin:$PATH&quot;
export LD_LIBRARY_PATH=/../openmpi/lib:$LD_LIBRARY_PATH
</pre>
<p>Set OpenMPI Path (cshrc):</p>
<pre class="code literal-block">
setenv PATH &quot;/../openmpi/bin:$PATH&quot;
setenv LD_LIBRARY_PATH /../openmpi/lib:$LD_LIBRARY_PATH
</pre>
<p>2: How to compile and link:</p>
<pre class="code literal-block">
make
</pre>
<p>How to clean:</p>
<pre class="code literal-block">
make  clean
</pre>
<p>3: Set HEADAS Paths:
Initialize the HEADAS and AtomDB (bash):</p>
<pre class="code literal-block">
export HEADAS=/../heasoft/x86_64-unknown-linux-gnu-libc2.12
source $HEADAS/headas-init.sh
export ATOMDB=/../atomdb/atomdb_v3.0.2
</pre>
<p>Initialize the HEADAS and AtomDB (cshrc):</p>
<pre class="code literal-block">
setenv HEADAS /../heasoft/x86_64-unknown-linux-gnu-libc2.12
source $HEADAS/headas-init.sh
setenv ATOMDB /../atomdb/atomdb_v3.0.2
</pre>
<p><em>Note:</em> The XSTAR program does not need AtomDB, and uses its own atomic data. However, AtomDB data are required for working with some plasma models in the <a class="reference external" href="http://space.mit.edu/cxc/isis/">Interactive Spectral Interpretation System (ISIS)</a>.</p>
<p>4: How to use mpirun for running mpixstar:</p>
<pre class="code literal-block">
mpirun -np number_of_processor ...
</pre>
<p>for example:</p>
<pre class="code literal-block">
mpirun --mca mpi_warn_on_fork 0 -np 8 ./mpixstar cfrac=0.4 \
temperature=100. lcpres=0 pressure=0.03 spectrum='pow' \
spectun=0 trad=-1. density=1.0e+12 densitytyp=0 \
columnsof=1.0e+20 columntyp=2 column=1.e+24 columnnst=9 columnint=1 \
rlrad38=1.e+6 rlogxityp=2 rlogxisof=0 rlogxi=5 rlogxinst=6 rlogxiint=0 \
habund=1 heabund=1 liabund=0 beabund=0 babund=0 cabund=1 \
nabund=1 oabund=1 fabund=0 neabund=1 naabund=0 mgabund=1 \
alabund=1 siabund=1 pabund=0 sabund=1 clabund=0 arabund=1 \
kabund=0 caabund=1 scabund=0 tiabund=0 vabund=0 crabund=1 \
mnabund=0 feabund=1 coabund=0 niabund=1 cuabund=0 znabund=0 \
modelname='xstar_pg1211' nsteps=10 niter=99 \
lwrite=0 lprint=1 lstep=0 emult=0.5 taumax=5. radexp=0. \
xeemin=0.1 critf=1.e-6 vturbi=100. npass=1 ncn2=9999
</pre>
<p>5: How to run mpirun on clusters and supercomputers:</p>
<p>In the batches folder, a sample of running batch files are included
for different job scheduling systems. To submit a batch file:</p>
<p>Portable Batch System (PBS):</p>
<pre class="code literal-block">
qsub mpixstar_run.job
</pre>
<p>Sun Grid Engine (SGE):</p>
<pre class="code literal-block">
qsub mpixstar_run.job
</pre>
<p>Simple Linux Utility for Resource Management (SLURM):</p>
<pre class="code literal-block">
sbatch mpixstar_run.sh
</pre>
</div>
<div class="section" id="acknowledgement">
<h2>Acknowledgement</h2>
<p>If you employ <strong>MPI_XSTAR</strong> in your scholarly work, please acknowledge the usage by citing the following reference:</p>
<ul class="simple">
<li>Danehkar, A., Nowak, M. A., Lee, J. C. and Smith, R. K. (2018). MPI_XSTAR: MPI-based Parallelization of the XSTAR Photoionization Program. <em>Publ. Astron. Soc. Pac.</em>, <strong>130</strong>, 024501. doi:<a class="reference external" href="https://doi.org/10.1088/1538-3873/aa9dff">10.1088/1538-3873/aa9dff</a>  ads:<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018PASP..130b4501D/abstract">2018PASP..130b4501D</a>.</li>
</ul>
<pre class="code bibtex literal-block">
<span class="name class">&#64;article</span><span class="punctuation">{</span><span class="name label">Danehkar2018</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">author</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{{Danehkar}, Ashkbiz and {Nowak}, Michael A. and {Lee}, Julia C. and
      {Smith}, Randall K.}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">title</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{MPI\_XSTAR: MPI-based Parallelization of the XSTAR Photoionization Program}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">journal</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{PASP}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">volume</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{130}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">number</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{984}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">pages</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{024501}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">year</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{2018}</span><span class="punctuation">,</span><span class="whitespace">
  </span><span class="name attribute">doi</span><span class="whitespace"> </span><span class="punctuation">=</span><span class="whitespace"> </span><span class="literal string">{10.1088/1538-3873/aa9dff}</span><span class="whitespace">
</span><span class="punctuation">}</span>
</pre>
</div>
<div class="section" id="learn-more">
<h2>Learn More</h2>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>Documentation</strong></td>
<td><a class="reference external" href="https://xstarkit.github.io/MPI_XSTAR/">https://xstarkit.github.io/MPI_XSTAR/</a></td>
</tr>
<tr><td><strong>Repository</strong></td>
<td><a class="reference external" href="https://github.com/xstarkit/MPI_XSTAR">https://github.com/xstarkit/MPI_XSTAR</a></td>
</tr>
<tr><td><strong>Issues &amp; Ideas</strong></td>
<td><a class="reference external" href="https://github.com/xstarkit/MPI_XSTAR/issues">https://github.com/xstarkit/MPI_XSTAR/issues</a></td>
</tr>
<tr><td><strong>DOI</strong></td>
<td><a class="reference external" href="https://doi.org/10.1088/1538-3873/aa9dff">10.1088/1538-3873/aa9dff</a></td>
</tr>
<tr><td><strong>Archive</strong></td>
<td><a class="reference external" href="https://doi.org/10.5281/zenodo.1890561">10.5281/zenodo.1890561</a></td>
</tr>
</tbody>
</table>
</div>
</div>

        <footer>
          MPI_XSTAR is maintained by <a href="https://github.com/xstarkit">xstarkit</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
